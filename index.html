<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
	#canvas-frame {
		width: 100%;
		height: 600px;
		background-color: #EEEEEE;
	}	
</style>
<script src="js/three.js"></script>
<script src="js/Stats.js"></script>
<script src="js/tween.min.js"></script>
<script src="js/clock.js"></script>
<script src="js/TrackballControls.js"></script>
<script>
	var width, height;
	var scene, camera, renderer;
	var light;
	var stats;
	var texture;
	var controls;
	function initRender () {
		width = document.getElementById('canvas-frame').clientWidth;
		height = document.getElementById('canvas-frame').clientHeight;
		renderer = new THREE.WebGLRenderer({
	         antialias : true
      	});
		renderer.setSize(width, height);
		renderer.setPixelRatio(devicePixelRatio)
		renderer.domElement.style.position = 'absolute';
		renderer.domElement.style.top = 0;
		document.getElementById('canvas-frame').appendChild(renderer.domElement);
		renderer.setClearColor(0xFFFFFF, 1.0);
		
		stats = new Stats();
	    stats.domElement.style.position = 'absolute';
	    stats.domElement.style.left = '0px';
	    stats.domElement.style.top = '0px';
	    document.getElementById('canvas-frame').appendChild(stats.domElement);
	}
	function initScene(){	
		scene = new THREE.Scene();
	}
	function initCamera(){
//		camera = new THREE.PerspectiveCamera(45, width/height, 1.0, 10000);
		camera = new THREE.OrthographicCamera(-width/2, width/2, height/2, -height/2, 1.0, 10000);
		camera.position.x = 300;
		camera.position.y = 200;
		camera.position.z = 1000;
		camera.up.x = 0;
		camera.up.y = 1;
		camera.up.z = 0;
		camera.lookAt({x : 0, y : 0, z : 0});
//		controls = new THREE.DeviceOrientationControls(camera);
		controls = new THREE.TrackballControls( camera );

        controls.rotateSpeed = 5.0;
        controls.zoomSpeed = 5;
        controls.panSpeed = 2;

        controls.noZoom = false;
        controls.noPan = false;

        controls.staticMoving = true;
        controls.dynamicDampingFactor = 0.3;
	}
	function initLight(){
		light = new THREE.AmbientLight(0xFF0000);//环境光
		light.position.set(100, 100, 200);
		scene.add(light);
		var light = new THREE.PointLight(0x00FF00);
		light.position.set(0,0, 50);
		scene.add(light);
/*	*/		
		light = new THREE.DirectionalLight(0x00FF00, 1);
		light.position.set(0, 100, 100);
		scene.add(light);
	}
	var mesh;
	function doit(){
				
//				var geometry = new THREE.CylinderGeometry(100, 150, 400, 10000, 1, false);

				
		var geometry = new THREE.CubeGeometry(100, 100, 50, 4, 4);
		var material = new THREE.MeshLambertMaterial({color: 0xFFFFFF});
/*
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(0, 0, 0);
		scene.add(mesh);
*/
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(0, 300, 0);
		scene.add(mesh);
		
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(0, -300, 0);
		scene.add(mesh);
		
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(300, 0, 0);
		scene.add(mesh);
		
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(-300, 0, 0);
		scene.add(mesh);
		
		mesh = new THREE.Mesh(geometry, material);
		mesh.position.set(0, 0, -300);
		scene.add(mesh);
/**/		
		geometry = new THREE.PlaneGeometry(200, 200, 1, 1);
		geometry.vertices[0].uv = new THREE.Vector2(0,0);
		geometry.vertices[1].uv = new THREE.Vector2(0,1);
		geometry.vertices[2].uv = new THREE.Vector2(1,1);
		geometry.vertices[3].uv = new THREE.Vector2(1,0);
		
//		var texture = THREE.ImageUtils.loadTexture("res/ice.jpg", null, function(t){});
/*		var loader = new THREE.TextureLoader();
		var afterLoad = function ( texture ) {
			// do something with the texture
			material = new THREE.MeshBasicMaterial( {
				map: texture
			 } );
		}
		texture = loader.load(
			"res/ice.jpg", null, function ( xhr ) {
				console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
			}, function ( xhr ) {
				console.log( 'An error happened' );
			}
		);
		material = new THREE.MeshBasicMaterial( {
			map: texture
		 } );
*/
		texture = new THREE.Texture(canvas);
		texture.needsUpdate = true;
        material = new THREE.MeshBasicMaterial({map: texture});
        mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);

      }
      function initTween(){
      	new TWEEN.Tween( camera.position)
				.to( { x: 600 }, 3000 ).easing( TWEEN.Easing.Elastic.Out).start();
//				.to( { x: 600 }, 3000 ).repeat( Infinity ).start();
      }
	function render() {
//    renderer.clear();
//    camera.position.x -= 1.0;
//    mesh.position.x -= 1.0;
		texture.needsUpdate = true;
		renderer.render(scene, camera);
		requestAnimationFrame(render);
		stats.update();
		TWEEN.update();
		controls.update();
     }
     function init(){
     	initRender();
     	initScene();
     	initCamera();
     	initLight();
     	Clock();
     	doit();
     	initTween();
     	render();
     }
      
</script>
</head>
	<body onload="init();">
		<div id="canvas-frame"></div>
		
	</body>
</html>